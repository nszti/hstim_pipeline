
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://nszti.github.io/hstim_pipeline/setup/matlab_integration.html">
      
      
        <link rel="prev" href="interpreter.html">
      
      
        <link rel="next" href="help.html">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>MATLAB Integration - HeureCa</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#matlab-engine-api-setup-for-pycharm-integration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="HeureCa" class="md-header__button md-logo" aria-label="HeureCa" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            HeureCa
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MATLAB Integration
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="usage.html" class="md-tabs__link">
          
  
  
  Setup

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../documentation/structure.html" class="md-tabs__link">
          
  
  
  Documentation

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="HeureCa" class="md-nav__button md-logo" aria-label="HeureCa" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    HeureCa
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="usage.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="interpreter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interpreter Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    MATLAB Integration
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="matlab_integration.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    MATLAB Integration
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#outlook" class="md-nav__link">
    <span class="md-ellipsis">
      Outlook
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-0-version-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      Step 0: Version Compatibility
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-install-matlab-engine-api" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Install MATLAB Engine API
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-place-m-and-py-files-are-in-the-same-folder" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Place .m and .py Files are in the same folder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-import-the-mainengine" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Import the main.engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-test-the-connection" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Test the Connection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-pass-parameters-from-python-to-matlab" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Pass Parameters from Python to MATLAB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-run-the-python-code" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Run the Python Code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#done" class="md-nav__link">
    <span class="md-ellipsis">
      🎉 Done!
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="help.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Help to avoid errors
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../documentation/structure.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../documentation/api.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../documentation/runs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#outlook" class="md-nav__link">
    <span class="md-ellipsis">
      Outlook
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-0-version-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      Step 0: Version Compatibility
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-install-matlab-engine-api" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Install MATLAB Engine API
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-place-m-and-py-files-are-in-the-same-folder" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Place .m and .py Files are in the same folder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-import-the-mainengine" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Import the main.engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-test-the-connection" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Test the Connection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-pass-parameters-from-python-to-matlab" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Pass Parameters from Python to MATLAB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-run-the-python-code" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Run the Python Code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#done" class="md-nav__link">
    <span class="md-ellipsis">
      🎉 Done!
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="matlab-engine-api-setup-for-pycharm-integration"><font color= "#000000">MATLAB Engine API Setup for PyCharm Integration</font></h1>
<p>This guide explains how to run a MATLAB <code>.m</code> script from a Python <code>.py</code> script using the MATLAB Engine API in PyCharm.</p>
<hr />
<h2 id="outlook">Outlook</h2>
<p>I took this <a href="https://www.youtube.com/watch?v=OocdPu1Tcrg" target="_blank" rel="noopener"><strong>video</strong></a> as a starting point, tried both ways, but found the Matlab engine API the feasible method. (however you’re more than welcome to solve the other one)<br />
Let’s assume ‘main.py’ is the main Python file which runs your Python project &amp; ‘main.m’ is the main Matlab file which you’d like to run in PyCharm. For this, you need to <br />
1) put the ‘main.m’ file in the same folder as the ‘main.py’,<br />
2) connect Matlab with PyCharm with a Matlab Engine API for Python,<br />
3) import the Matlab engine into the ‘main.py’ and call the Matlab code. <br />
Keep in mind, that for this method, you need Matlab to be installed. </p>
<hr />
<h2 id="step-0-version-compatibility">Step 0: Version Compatibility</h2>
<ul>
<li>First and foremost, check the version of Python which you’re working with. (If you're working in .venv, check that as well and take that into account too). Also check that you’re working with a <strong>64 bit</strong> version of Python to match the architecture of Matlab.</li>
<li>Check your Matlab release version too. </li>
<li>Crucial step!: Check the compatibility of your Python and Matlab <a href="https://www.mathworks.com/support/requirements/python-compatibility.html" target="_blank" rel="noopener"><strong>here</strong></a>.</li>
</ul>
<hr />
<h2 id="step-1-install-matlab-engine-api">Step 1: Install MATLAB Engine API</h2>
<ol>
<li>The matlab engine API is within the installed MATLAB package. To avoid any permission errors and other issues  run cmd as an Administrator (OR if you’re running your ‘main.py’ from a virtual environment -in my case anaconda3- open anaconda prompt as an Administrator).</li>
<li>While in the virtual environment, direct to the API folder, which is usually in the following path:</li>
</ol>
<pre><code>C:\Program Files\MATLAB\[your_version]\extern\engines\python
</code></pre>
<p>If you direct to this path, you should see the ‘setup.py’ file.
3. In the command line, install this with the following command:</p>
<pre><code>python setup.py install
</code></pre>
<p>For alternative installation methods, refer to the <a href="https://se.mathworks.com/help/matlab/matlab_external/install-the-matlab-engine-for-python.html" target="_blank" rel="noopener"><strong>official guide</strong></a>.</p>
<hr />
<h2 id="step-2-place-m-and-py-files-are-in-the-same-folder">Step 2: Place <code>.m</code> and <code>.py</code> Files are in the same folder</h2>
<p>Put your <code>main.m</code> file in the same folder where you run your <code>main.py</code> file from.</p>
<hr />
<h2 id="step-3-import-the-mainengine">Step 3: Import the <code>main.engine</code></h2>
<p>In your <code>main.py</code>:</p>
<pre><code class="language-python">import matlab.engine
</code></pre>
<p>If you get the `No module named 'matlab' error, then your API installation wasn’t successful:(( 
Check if you installed the engine to the right path.</p>
<hr />
<h2 id="step-4-test-the-connection">Step 4: Test the Connection</h2>
<p>Check if you were successful and matlab is connected to PyCharm with the following code:
You can also see how you can start the engine <a href="https://www.mathworks.com/help/matlab/matlab_external/start-the-matlab-engine-for-python.html" target="_blank" rel="noopener"><strong>here</strong></a>.</p>
<pre><code class="language-python">import matlab.engine
eng = matlab.engine.start_matlab()
eng.eval(&quot;disp('Connected to MATLAB')&quot;, nargout=0)
eng.quit()
</code></pre>
<hr />
<h2 id="step-5-pass-parameters-from-python-to-matlab">Step 5: Pass Parameters from Python to MATLAB</h2>
<p>So far, the setup can run a MATLAB code, but can not overwrite the variables dynamically. To overwrite a variable in Python and ensure MATLAB uses it when you call the MATLAB function via the API, you can pass it as an argument to your MATLAB function.</p>
<p>Theoretically, the other option would be to assign it directly in the MATLAB workspace with <code>eng.workspace[‘data_path’] = …</code></p>
<p>HOWEVER for me, it resulted in an error saying unrecognised function or variable, which confirms that (in this case) <code>data_path</code> is not visible in the function scope of the MATLAB script. This presumably is because variables set in the MATLAB base workspace (via Python eng.workspace['...'] = ...) are not automatically visible inside the functions. Therefore, we’re left with passing the variables as arguments.
For this, you have to modify the code to a <strong>function</strong> that accepts the data_path and other variables as inputs. (make sure you don’t clear the assigned variables).</p>
<hr />
<h2 id="step-6-run-the-python-code">Step 6: Run the Python Code</h2>
<p>Run the MATLAB code via the API, you can call the MATLAB script as if it were a Python function with:</p>
<pre><code class="language-python"> eng.[matlab_script_name ](params, nargout = 0)
</code></pre>
<hr />
<h2 id="done">🎉 Done!</h2>
<p><a href="https://kumospace.mo.cloudinary.net/https://content.kumospace.com/hubfs/success-one-thing.jpg?tx=c_scale,w_600,h_770" target="_blank" rel="noopener"><strong>Congratulations</strong></a> — your Python project now integrates MATLAB! 🤯🥳</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "toggle", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>